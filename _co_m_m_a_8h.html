<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoMMA: CoMMA_lib/CoMMA.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CoMMA<span id="projectnumber">&#160;v1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_co_m_m_a_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">CoMMA.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;iterator&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;unordered_set&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="_agglomerator_8h_source.html">Agglomerator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_co_m_m_a_types_8h_source.html">CoMMATypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_coarse___cell___container_8h_source.html">Coarse_Cell_Container.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_dual___graph_8h_source.html">Dual_Graph.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_seeds___pool_8h_source.html">Seeds_Pool.h</a>&quot;</code><br />
</div>
<p><a href="_co_m_m_a_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a906c231be20a1f53a240618bae81d95f"><td class="memTemplParams" colspan="2">template&lt;typename CoMMAIndexType , typename CoMMAWeightType , typename CoMMAIntType &gt; </td></tr>
<tr class="memitem:a906c231be20a1f53a240618bae81d95f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="_co_m_m_a_8h.html#a906c231be20a1f53a240618bae81d95f">agglomerate_one_level</a> (const vector&lt; CoMMAIndexType &gt; &amp;adjMatrix_row_ptr, const vector&lt; CoMMAIndexType &gt; &amp;adjMatrix_col_ind, const vector&lt; CoMMAWeightType &gt; &amp;adjMatrix_areaValues, const vector&lt; CoMMAWeightType &gt; &amp;volumes, const vector&lt; vector&lt; CoMMAWeightType &gt; &gt; &amp;centers, const vector&lt; CoMMAWeightType &gt; &amp;priority_weights, const vector&lt; CoMMAIndexType &gt; &amp;anisotropicCompliantCells, const vector&lt; CoMMAIntType &gt; &amp;n_bnd_faces, bool build_anisotropic_lines, bool is_anisotropic, bool odd_line_length, CoMMAWeightType threshold_anisotropy, const CoMMAIntType seed_ordering_type, vector&lt; CoMMAIndexType &gt; &amp;fc_to_cc, vector&lt; CoMMAIndexType &gt; &amp;agglomerationLines_Idx, vector&lt; CoMMAIndexType &gt; &amp;agglomerationLines, bool correction, CoMMAIntType dimension, CoMMAIntType goal_card, CoMMAIntType min_card, CoMMAIntType max_card, CoMMAIntType singular_card_thresh=1, CoMMAIntType fc_choice_iter=1, const CoMMAIntType neighbourhood_type=<a class="el" href="_co_m_m_a_types_8h.html#a317369a7239fe01b94e2a7450c448531a6bc295e29b5149df1ca1d0bc868d3735">CoMMANeighbourhoodT::EXTENDED</a>)</td></tr>
<tr class="memdesc:a906c231be20a1f53a240618bae81d95f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function of the agglomerator, it is used as an interface to build up all the agglomeration process. The result will be the definition of the agglomerated cells <code>fc_to_cc</code>.  <a href="_co_m_m_a_8h.html#a906c231be20a1f53a240618bae81d95f">More...</a><br /></td></tr>
<tr class="separator:a906c231be20a1f53a240618bae81d95f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a06c8f4babe70bb7080dba80cf0473b21"><td class="memItemLeft" align="right" valign="top">constexpr unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_co_m_m_a_8h.html#a06c8f4babe70bb7080dba80cf0473b21">max_iter</a> = 4</td></tr>
<tr class="memdesc:a06c8f4babe70bb7080dba80cf0473b21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum allowed iterations for the iterative algorithm, see <a class="el" href="class_agglomerator___iterative.html">Agglomerator_Iterative</a>.  <a href="_co_m_m_a_8h.html#a06c8f4babe70bb7080dba80cf0473b21">More...</a><br /></td></tr>
<tr class="separator:a06c8f4babe70bb7080dba80cf0473b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a906c231be20a1f53a240618bae81d95f" name="a906c231be20a1f53a240618bae81d95f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a906c231be20a1f53a240618bae81d95f">&#9670;&#160;</a></span>agglomerate_one_level()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename CoMMAIndexType , typename CoMMAWeightType , typename CoMMAIntType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void agglomerate_one_level </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; CoMMAIndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>adjMatrix_row_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; CoMMAIndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>adjMatrix_col_ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; CoMMAWeightType &gt; &amp;&#160;</td>
          <td class="paramname"><em>adjMatrix_areaValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; CoMMAWeightType &gt; &amp;&#160;</td>
          <td class="paramname"><em>volumes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; vector&lt; CoMMAWeightType &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>centers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; CoMMAWeightType &gt; &amp;&#160;</td>
          <td class="paramname"><em>priority_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; CoMMAIndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>anisotropicCompliantCells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; CoMMAIntType &gt; &amp;&#160;</td>
          <td class="paramname"><em>n_bnd_faces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>build_anisotropic_lines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_anisotropic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>odd_line_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAWeightType&#160;</td>
          <td class="paramname"><em>threshold_anisotropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CoMMAIntType&#160;</td>
          <td class="paramname"><em>seed_ordering_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; CoMMAIndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>fc_to_cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; CoMMAIndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>agglomerationLines_Idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; CoMMAIndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>agglomerationLines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>correction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAIntType&#160;</td>
          <td class="paramname"><em>dimension</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAIntType&#160;</td>
          <td class="paramname"><em>goal_card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAIntType&#160;</td>
          <td class="paramname"><em>min_card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAIntType&#160;</td>
          <td class="paramname"><em>max_card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAIntType&#160;</td>
          <td class="paramname"><em>singular_card_thresh</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoMMAIntType&#160;</td>
          <td class="paramname"><em>fc_choice_iter</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CoMMAIntType&#160;</td>
          <td class="paramname"><em>neighbourhood_type</em> = <code><a class="el" href="_co_m_m_a_types_8h.html#a317369a7239fe01b94e2a7450c448531a6bc295e29b5149df1ca1d0bc868d3735">CoMMANeighbourhoodT::EXTENDED</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function of the agglomerator, it is used as an interface to build up all the agglomeration process. The result will be the definition of the agglomerated cells <code>fc_to_cc</code>. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">CoMMAIndexType</td><td>the CoMMA index type for the global index of the mesh </td></tr>
    <tr><td class="paramname">CoMMAWeightType</td><td>the CoMMA weight type for the weights (volume or area) of the nodes or edges of the Mesh </td></tr>
    <tr><td class="paramname">CoMMAIntType</td><td>the CoMMA type for integers </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">adjMatrix_row_ptr</td><td>the row pointer of the CRS representation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">adjMatrix_col_ind</td><td>the column index of the CRS representation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">adjMatrix_areaValues</td><td>the weight of the CRS representation (in CoMMA case will be the area of the faces that in the graph representation are the edges between two nodes represented by the cell centers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">volumes</td><td>The volumes of the cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">centers</td><td>Cell centers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">priority_weights</td><td>Weights used to set the order telling where to start agglomerating. The higher the weight, the higher the priority </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anisotropicCompliantCells</td><td>List of cells which have to be looked for anisotropy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_bnd_faces</td><td>Vector telling how many boundary faces each cell has </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">build_anisotropic_lines</td><td>Whether lines joining the anisotropic cells should be built, otherwise, if the anisotropic agglomeration is activated, the lines should be provided, see <code>agglomerationLines_Idx</code> and <code>agglomerationLines</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_anisotropic</td><td>Whether to consider an anisotropic agglomeration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">odd_line_length</td><td>Whether anisotropic lines with odd length are allowed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold_anisotropy</td><td>Value of the aspect-ratio above which a cell is considered as anisotropic. If negative, all compliant cells are considered as anisotropic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed_ordering_type</td><td>Type of ordering for the seeds of the coarse cells. Possible values (see <a class="el" href="_co_m_m_a_types_8h.html#a21d465186a970946f27155976c4d2ef4">CoMMASeedsPoolT</a>):<ul>
<li>0: The number of boundary faces has highest priority</li>
<li>1: The neighbourhood has highest priority (neighbours of coarse cells have priority)</li>
<li>10: The number of boundary faces has highest priority, and initialize with one point only then let evolve</li>
<li>11: The neighbourhood has highest priority, and initialize with one point only then let evolve </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fc_to_cc</td><td>Vector telling the ID of the coarse cell to which a fine cell belongs after agglomeration </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">agglomerationLines_Idx</td><td>Connectivity for the agglomeration lines: each element points to a particular element in the vector <code>agglomerationLines</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">agglomerationLines</td><td>Vector storing all the elements of the anisotropic lines </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">correction</td><td>Whether to apply correction step (avoid isolated cells) after agglomeration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dimension</td><td>Dimensionality of the problem, 2- or 3D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">goal_card</td><td>Expected cardinality of the coarse cells (might not be ensured) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">min_card</td><td>Minimum cardinality accepted for the coarse cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_card</td><td>Maximum cardinality accepted for the coarse cells </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">singular_card_thresh</td><td>(optional, default=1) Cardinality below which a coarse is considered as singular, hence, compliant for correction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fc_choice_iter</td><td>(optional, default=1) Number of iterations allowed for the algorithm choosing which fine cell to add next. The cost grows exponentially, hence use small values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbourhood_type</td><td>(optional, default=Extended) Type of neighbourhood to use when growing a coarse cell. See <a class="el" href="_co_m_m_a_types_8h.html#a317369a7239fe01b94e2a7450c448531">CoMMANeighbourhoodT</a> for more details. Two alternatives:<ul>
<li>Extended: requested with 0, standard algorithm where we consider every neighbour of the coarse cell as candidate.</li>
<li>Pure Front Advancing: requested with 1, only direct neighbours of the last added cell are candidates. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">invalid_argument</td><td>whenever dimension is not 2 nor 3, cardinalities are smaller than 1 or not in order, line building is disabled but lines are not provided, or number of iterations is negative or greater than <a class="el" href="_co_m_m_a_8h.html#a06c8f4babe70bb7080dba80cf0473b21">max_iter</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright © 2023 ONERA </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Nicolas Lantos, Alberto Remigi, and Riccardo Milani </dd></dl>
<dl class="section user"><dt>Contributor</dt><dd>Karim Anemiche </dd></dl>
<dl class="section user"><dt>License</dt><dd>This project is released under the Mozilla Public License 2.0, see <a href="https://mozilla.org/MPL/2.0/">https://mozilla.org/MPL/2.0/</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a06c8f4babe70bb7080dba80cf0473b21" name="a06c8f4babe70bb7080dba80cf0473b21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c8f4babe70bb7080dba80cf0473b21">&#9670;&#160;</a></span>max_iter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr unsigned short max_iter = 4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum allowed iterations for the iterative algorithm, see <a class="el" href="class_agglomerator___iterative.html">Agglomerator_Iterative</a>. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f7d8b6c0f4428b0df38184f730f938dc.html">CoMMA_lib</a></li><li class="navelem"><a class="el" href="_co_m_m_a_8h.html">CoMMA.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
